<template>
  <view class="page">
    <view class="top-nav" :style="{ paddingTop: statusBarHeight + 'px' }">
      <text class="nav-title">å·¥å…·</text>
      <view class="nav-actions">
        <text class="more-icon" @click="showMoreTools">â‹¯</text>
      </view>
    </view>

    <scroll-view
      class="scroll"
      scroll-y
      enable-back-to-top="true"
      refresher-enabled="true"
      :refresher-triggered="isRefreshing"
      @refresherrefresh="refreshTools"
    >
      <view class="section">
        <text class="section-subtitle">äº†è§£è‡ªæˆ‘</text>
        <text class="section-title">èŒä¸šæµ‹è¯„</text>
        <view class="card" @click="handleToolClick('mbti')">
          <view class="card-left">
            <text class="card-icon">ğŸ§ </text>
            <view class="card-info">
              <text class="card-title">MBTI æ€§æ ¼æµ‹è¯•</text>
              <text class="card-desc">93 é¢˜å¿«é€Ÿå›ç­”,åŒ¹é… 16 å‹äººæ ¼</text>
              <text class="card-tag">æœ¬åœ°è®¡ç®—ç»“æœ,ä¸ä¸Šä¼ ç­”æ¡ˆ</text>
            </view>
          </view>
          <text class="card-status use-now">ç«‹å³ä½¿ç”¨</text>
        </view>

        <view class="card" @click="handleToolClick('career-assessment')">
          <view class="card-left">
            <text class="card-icon">ğŸ¯</text>
            <view class="card-info">
              <text class="card-title">éœå…°å¾·èŒä¸šå…´è¶£</text>
              <text class="card-desc">RIASEC å…­ç»´æµ‹è¯„,æ‰¾åˆ°ä¼˜åŠ¿é¢†åŸŸ</text>
              <text class="card-tag">60 é¢˜æ ‡å‡†é—®å·</text>
            </view>
          </view>
          <text class="card-status use-now">ç«‹å³ä½¿ç”¨</text>
        </view>
      </view>

      <view class="section">
        <text class="section-subtitle">ç²¾ç®—æ”¶å…¥</text>
        <text class="section-title">è–ªé…¬ä¸ç¨åŠ¡</text>
        <view class="card" @click="handleToolClick('tax-calculator')">
          <view class="card-left">
            <text class="card-icon">ğŸ§®</text>
            <view class="card-info">
              <text class="card-title">ä¸ªäººæ‰€å¾—ç¨è®¡ç®—</text>
              <text class="card-desc">2024 ç¨ç‡è¡¨,å®æ—¶ä¼°ç®—ç¨åæ”¶å…¥</text>
              <text class="card-tag">æ”¯æŒä¸“é¡¹é™„åŠ æ‰£é™¤</text>
            </view>
          </view>
          <text class="card-status use-now">ç«‹å³ä½¿ç”¨</text>
        </view>

      </view>

      <view class="section">
        <text class="section-subtitle">å¤‡æˆ˜é¢è¯•</text>
        <text class="section-title">æ±‚èŒå·¥å…·</text>
        <view class="card" @click="handleToolClick('interview-questions')">
          <view class="card-left">
            <text class="card-icon">ğŸ’¬</text>
            <view class="card-info">
              <text class="card-title">é¢è¯•é¢˜åº“åŠ©æ‰‹</text>
              <text class="card-desc">è¡Œä¸ºã€æƒ…æ™¯ä¸ HR é«˜é¢‘é¢˜ä¸€ç›®äº†ç„¶</text>
              <text class="card-tag">å«ç­”é¢˜æ€è·¯ä¸å¤ç›˜æç¤º</text>
            </view>
          </view>
          <text class="card-status use-now">ç«‹å³ä½¿ç”¨</text>
        </view>
      </view>

      <view class="section">
        <text class="section-subtitle">æŒæ§èŠ‚å¥</text>
        <text class="section-title">æ•ˆç‡ä¸èº«å¿ƒ</text>
        <view class="card" @click="handleToolClick('time-matrix')">
          <view class="card-left">
            <text class="card-icon">â±ï¸</text>
            <view class="card-info">
              <text class="card-title">è‰¾æ£®è±ªå¨å°”æ—¶é—´çŸ©é˜µ</text>
              <text class="card-desc">åˆ’åˆ†å››è±¡é™,æ’å®šæ¯æ—¥ä¼˜å…ˆçº§</text>
              <text class="card-tag">æ”¯æŒé•¿æŒ‰åˆ é™¤ä¸åˆ†ç±»</text>
            </view>
          </view>
          <text class="card-status use-now">ç«‹å³ä½¿ç”¨</text>
        </view>

        <view class="card" @click="handleToolClick('stress-assessment')">
          <view class="card-left">
            <text class="card-icon">ğŸŒ¿</text>
            <view class="card-info">
              <text class="card-title">èŒåœºå‹åŠ›è‡ªæµ‹</text>
              <text class="card-desc">20 é¢˜äº†è§£å‹åŠ›æ°´å¹³,è·å–å‡å‹å»ºè®®</text>
              <text class="card-tag">æ¶µç›–æƒ…ç»ªã€ç¡çœ ä¸æ”¯æŒåº¦</text>
            </view>
          </view>
          <text class="card-status use-now">ç«‹å³ä½¿ç”¨</text>
        </view>
      </view>

      <view class="bottom-space" />
    </scroll-view>
  </view>
</template>

<script>
export default {
  data() {
    return {
      statusBarHeight: 0,
      isRefreshing: false
    };
  },
  onLoad() {
    const info = uni.getSystemInfoSync();
    this.statusBarHeight = info.statusBarHeight || 0;
  },
  methods: {
    handleToolClick(toolType) {
      const toolRoutes = {
        mbti: '/pages/tools/mbti-test/mbti-test',
        'career-assessment': '/pages/tools/career-assessment/career-assessment',
        'tax-calculator': '/pages/tools/tax-calculator/tax-calculator',
        'interview-questions': '/pages/tools/interview-questions/interview-questions',
        'time-matrix': '/pages/tools/time-matrix/time-matrix',
        'stress-assessment': '/pages/tools/stress-assessment/stress-assessment'
      };

      if (toolRoutes[toolType]) {
        uni.navigateTo({ url: toolRoutes[toolType] });
        return;
      }

      const toolNames = {};

      const name = toolNames[toolType] || 'è¯¥åŠŸèƒ½';
      this.showComingSoon(name);
    },
    showComingSoon(name) {
      uni.showModal({
        title: 'å³å°†ä¸Šçº¿',
        content: `${name}æ­£åœ¨ç­¹å¤‡ä¸­,æˆ‘ä»¬æ­£åœ¨æ¥å…¥æœ€æ–°æ•°æ®æº,æ•¬è¯·æœŸå¾…ã€‚`,
        showCancel: false,
        confirmText: 'çŸ¥é“äº†'
      });
    },
    showMoreTools() {
      uni.showActionSheet({
        itemList: ['æˆ‘è¦æéœ€æ±‚', 'æ„è§åé¦ˆ', 'å…³äºå·¥å…·'],
        success: (res) => {
          if (res.tapIndex === 0) {
            this.goToFeedback('å·¥å…·éœ€æ±‚');
          } else if (res.tapIndex === 1) {
            this.goToFeedback('æ„è§åé¦ˆ');
          } else if (res.tapIndex === 2) {
            uni.showModal({
              title: 'å…³äºå·¥å…·',
              content: 'Herizon æ­£é€æ­¥ä¸Šçº¿æ›´å¤šèŒåœºå·¥å…·,æ¬¢è¿éšæ—¶å‘Šè¯‰æˆ‘ä»¬æœ€æƒ³è¦çš„èƒ½åŠ›ã€‚',
              showCancel: false,
              confirmText: 'äº†è§£'
            });
          }
        }
      });
    },
    goToFeedback(type) {
      uni.navigateTo({
        url: `/pages/feedback/feedback?type=${encodeURIComponent(type)}`
      });
    },
    refreshTools() {
      this.isRefreshing = true;
      setTimeout(() => {
        this.isRefreshing = false;
      }, 500);
    }
  }
};
</script>

<style scoped>
.page {
  display: flex;
  flex-direction: column;
  height: 100vh;
  background: linear-gradient(180deg, #f9fafb 0%, #f3f4f6 100%);
}

.top-nav {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(12px);
  box-shadow: 0 2px 8px rgba(15, 23, 42, 0.08);
}

.nav-title {
  font-size: 20px;
  font-weight: 700;
  color: #111827;
}

.nav-actions {
  display: flex;
  align-items: center;
}

.more-icon {
  font-size: 22px;
  color: #6b7280;
  padding: 6px 10px;
}

.scroll {
  flex: 1;
  padding: 20px 24px 32px;
  box-sizing: border-box;
}

.section {
  margin-bottom: 32px;
}

.section-subtitle {
  font-size: 14px;
  color: #6b7280;
  letter-spacing: 1px;
}

.section-title {
  display: block;
  margin: 6px 0 16px;
  font-size: 22px;
  font-weight: 700;
  color: #1f2937;
}

.card {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 22px 20px;
  margin-bottom: 16px;
  border-radius: 20px;
  background: #ffffff;
  box-shadow: 0 10px 30px rgba(15, 23, 42, 0.06);
}

.card-left {
  display: flex;
  align-items: flex-start;
  gap: 16px;
  flex: 1;
}

.card-icon {
  font-size: 28px;
}

.card-info {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.card-title {
  font-size: 18px;
  font-weight: 600;
  color: #111827;
}

.card-desc {
  font-size: 14px;
  color: #4b5563;
  line-height: 1.5;
}

.card-tag {
  font-size: 12px;
  color: #6d28d9;
}

.card-status {
  min-width: 96px;
  text-align: center;
  font-size: 14px;
  font-weight: 600;
  padding: 8px 12px;
  border-radius: 999px;
}

.card-status.use-now {
  color: #047857;
  background: #d1fae5;
}

.card-status.coming-soon {
  color: #92400e;
  background: #fef3c7;
}

.bottom-space {
  height: 48px;
}
</style>
